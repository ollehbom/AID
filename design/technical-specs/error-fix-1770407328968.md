# Technical Specification: Core UI Foundation (error-fix-1770407328968)

## Architecture Overview
The system will consist of a Single-Page Application (SPA) built with React, leveraging Shadcn UI for its component library. This frontend application will be deployed as static assets via a Content Delivery Network (CDN) for high availability and performance. User authentication will be handled through Google OAuth, with the frontend initiating the flow and the backend responsible for verifying Google ID tokens and issuing product-specific session tokens. The frontend will communicate with the backend API over HTTPS for authentication and to retrieve initial dashboard data.

## Components

### 1. Frontend Application (React SPA)
- **Framework:** React
- **UI Library:** Shadcn UI (built on Radix UI and Tailwind CSS)
- **Routing:** React Router
- **Authentication Library:** `@react-oauth/google` or similar for Google OAuth integration.
- **Key Modules/Components:**
    - `LoginPage`: Renders the Google Sign-in button and handles OAuth initiation/callbacks.
    - `DashboardPage`: The main authenticated landing page, displaying user-specific (initially mock) content.
    - `AuthContext/Provider`: Manages user authentication state and provides access to session information throughout the app.
    - `Shadcn UI Components`: Reusable UI elements (Button, Card, Input, Dialog, etc.) for consistent styling and interaction.
    - `ErrorDisplay`: Generic component for rendering error messages.
    - `LoadingSpinner`: Generic component for indicating loading states.

### 2. Backend API (Existing/New Endpoints)
- **Purpose:** Verifies Google ID tokens, manages user accounts, issues/validates product-specific session tokens, and provides data for the dashboard.
- **Key Endpoints (New/Modified):**
    - `/api/auth/google`: Handles Google ID token verification and session creation.
    - `/api/user/me`: Retrieves authenticated user's profile information.
- **Security:** Must validate all incoming Google ID tokens with Google's OAuth servers and ensure product-specific tokens are securely generated and validated.

## Data Models

### User (Backend Database)
```json
{
  "id": "uuidv4",
  "email": "string (unique)",
  "name": "string",
  "google_id": "string (unique, nullable, indexed)",
  "created_at": "datetime",
  "updated_at": "datetime"
}
```

### Session (Backend Database / Cache)
```json
{
  "id": "uuidv4",
  "user_id": "uuidv4 (foreign key to User.id)",
  "token": "string (secure, unique, indexed)",
  "expires_at": "datetime",
  "created_at": "datetime"
}
```

## APIs

### 1. Endpoint: `POST /api/auth/google`
- **Description:** Authenticates a user using a Google ID token.
- **Request Body:**
```json
{
  "idToken": "string" // Google ID token received from frontend
}
```
- **Response (Success - HTTP 200 OK):**
```json
{
  "accessToken": "string", // Product-specific access token
  "user": {
    "id": "string",
    "email": "string",
    "name": "string"
  }
}
```
- **Response (Error - HTTP 400 Bad Request / 401 Unauthorized / 500 Internal Server Error):**
```json
{
  "error": "string",
  "message": "string"
}
```
- **Authentication Requirements:** None (this is the initial authentication endpoint).
- **Error Handling:** Invalid token, Google API errors, internal server errors.

### 2. Endpoint: `GET /api/user/me`
- **Description:** Retrieves the profile of the currently authenticated user.
- **Request Body:** None.
- **Request Headers:**
    - `Authorization: Bearer <accessToken>` (Product-specific access token)
- **Response (Success - HTTP 200 OK):**
```json
{
  "id": "string",
  "email": "string",
  "name": "string"
}
```
- **Response (Error - HTTP 401 Unauthorized / 403 Forbidden / 500 Internal Server Error):**
```json
{
  "error": "string",
  "message": "string"
}
```
- **Authentication Requirements:** Valid product-specific access token in `Authorization` header.
- **Error Handling:** Invalid/expired token, user not found, internal server errors.

## Infrastructure

- **Frontend Hosting:** Cloud-based static site hosting with CDN (e.g., AWS S3 + CloudFront, Vercel, Netlify). This provides global accessibility, low latency, high availability, and easy scalability.
- **Backend:** Existing backend service infrastructure. Ensure the new authentication endpoint is exposed securely over HTTPS.
- **DNS:** Standard DNS configuration to point the application domain to the CDN.
- **SSL/TLS:** Mandatory HTTPS for all communication between client and server, and for static asset delivery.

## Testing Strategy

- **Unit Tests (Frontend):**
    - **Tooling:** Jest, React Testing Library.
    - **Scope:** Individual React components (Login button, Dashboard layout, UI elements), custom hooks, utility functions.
    - **Focus:** Component rendering, state management, event handling, adherence to Shadcn UI patterns.
- **Integration Tests (Frontend & Backend):**
    - **Tooling:** Cypress or Playwright for end-to-end (E2E) UI testing.
    - **Scope:** Full user flows: Google login initiation -> callback -> backend token exchange -> dashboard redirect -> dashboard content rendering.
    - **Focus:** API integration, correct redirection, secure token handling, UI responsiveness to backend states.
- **Manual Testing:**
    - **Scope:** Founder review for intuitiveness, modern feel, and adherence to design intent.
    - **Focus:** User experience, visual consistency, accessibility basics.
- **Security Testing:**
    - **Scope:** Authentication endpoint (backend) and token storage/usage (frontend).
    - **Focus:** OWASP Top 10 for web applications, specifically related to authentication and session management. Ensure secure cookie flags (HTTP-only, Secure, SameSite) are used for session tokens.

## Deployment

- **Frontend Deployment:**
    - **CI/CD Pipeline:** Automated build (Webpack/Vite) and deployment of static assets to the CDN on every successful merge to the main branch.
    - **Cache Invalidation:** CDN cache invalidation will be triggered post-deployment to ensure users receive the latest version.
    - **Rollback:** Versioned deployments will allow for quick rollback to a previous working version by updating the CDN origin or DNS record.
- **Backend Deployment:**
    - **CI/CD Pipeline:** Standard backend deployment process for the new authentication and user endpoints.
    - **Zero-Downtime Deployment:** Implement strategies like blue/green or rolling deployments to ensure continuous service availability.
- **Feature Flags:** Not strictly required for this foundational feature, but will be integrated for future feature development.
- **Monitoring and Alerts:**
    - **Frontend:** Implement error monitoring (e.g., Sentry, LogRocket) for client-side errors and performance monitoring (e.g., Google Analytics, custom RUM solutions) for page load times and core web vitals.
    - **Backend:** Standard API monitoring (e.g., Prometheus/Grafana, Datadog) for endpoint latency, error rates, and resource utilization for the new auth endpoints.
    - **Alerts:** Configure alerts for critical errors, authentication failures, and performance degradation thresholds.
