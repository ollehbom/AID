# Technical Specification: Initial UI/UX and Authentication Setup

## 1. Overview
This document outlines the technical approach for establishing the product's foundational UI/UX and authentication system. It covers the client-side React application with `shadcn/ui`, Google OAuth integration, and the minimal backend components required for secure authentication. The goal is to provide a robust, scalable, and maintainable base for all future feature development.

## 2. Architecture Overview
The system will comprise a client-side React application hosted as a static site, interacting with a minimal serverless backend for secure Google OAuth token exchange and session management. All communication will be secured via HTTPS.

```mermaid
graph TD
    A[User] -->|1. Navigate to App URL| B(CDN/Static Host)
    B -->|2. Serve React App| A
    A -->|3. Click 'Sign in with Google'| C{React App}
    C -->|4. Redirect to Google Auth| D[Google Identity Platform]
    D -->|5. User Authenticates & Authorizes| C
    C -->|6. Send Google Auth Code/Token| E[Serverless Auth Backend]
    E -->|7. Validate Token & Create Session| D
    E -->|8. Issue Session Token (e.g., JWT in HTTP-only cookie)| C
    C -->|9. Redirect to Dashboard| A
    A -->|10. Access Protected Resources (with Session Token)| F[Future Backend Services]

    subgraph Frontend (React App)
        C
    end

    subgraph Backend (Serverless)
        E
    end

    style A fill:#f9f,stroke:#333,stroke-width:2px
    style B fill:#bbf,stroke:#333,stroke-width:2px
    style C fill:#ccf,stroke:#333,stroke-width:2px
    style D fill:#fcf,stroke:#333,stroke-width:2px
    style E fill:#cff,stroke:#333,stroke-width:2px
    style F fill:#dfd,stroke:#333,stroke-width:2px
```

## 3. Components

### 3.1. Frontend (React Application)
-   **Root Component (`App.tsx`)**: Manages global state (e.g., authentication status), routing (`react-router-dom`), and layout.
-   **Landing Page (`LandingPage.tsx`)**: Unauthenticated view, displaying product name, tagline, and "Sign in with Google" button.
-   **Auth Button (`GoogleSignInButton.tsx`)**: Encapsulates the Google OAuth initiation logic and displays loading states.
-   **Dashboard (`Dashboard.tsx`)**: Authenticated view, displaying "Dashboard" H1, basic navigation placeholders, and mock content (e.g., Welcome Card, Recent Activity section).
-   **UI Components**: Utilizes `shadcn/ui` for `Button`, `Card`, `Typography`, `Input`, `Dialog` (for errors) etc., styled with Tailwind CSS.
-   **Loading Indicators (`LoadingSpinner.tsx`)**: Visual feedback during authentication redirects and data fetching.
-   **Error Notifications (`ErrorBanner.tsx`)**: Display persistent or dismissible error messages for auth failures or general system issues.

### 3.2. Backend (Serverless Auth Service)
-   **Google OAuth Callback Endpoint (`/api/auth/google/callback`)**: 
    -   Receives the authorization code from Google after user authentication.
    -   Exchanges the authorization code for access and ID tokens with Google's API.
    -   Validates the ID token to verify user identity and integrity.
    -   Creates or retrieves a user record in the database (if necessary for future features).
    -   Generates a secure, HTTP-only, `SameSite=Lax` cookie containing a session token (e.g., JWT) for the client.
    -   Redirects the client to the `/dashboard` route.

## 4. Data Models

### 4.1. Frontend User State
```typescript
interface User {
  id: string;        // Unique user ID (from Google or internal DB)
  name: string;      // User's display name
  email: string;     // User's email address
  avatarUrl?: string; // URL to user's profile picture
}
```

### 4.2. Backend Session Token (JWT Payload Example)
```json
{
  "sub": "[Google User ID]",
  "email": "user@example.com",
  "name": "John Doe",
  "iat": 1678886400, // Issued at timestamp
  "exp": 1678890000  // Expiration timestamp
}
```

## 5. APIs

### 5.1. Frontend-Initiated Google OAuth Flow
-   **Client-side**: Uses `@react-oauth/google` or similar to initiate the Google OAuth flow, handling redirects to `accounts.google.com`.

### 5.2. Backend Authentication Endpoint
-   **Endpoint**: `POST /api/auth/google/callback`
    -   **Description**: Handles the callback from Google OAuth, exchanges the authorization code, validates the ID token, and establishes a secure session.
    -   **Request (Body)**:
        ```json
        {
          "code": "<google_authorization_code>"
        }
        ```
    -   **Response (Headers)**:
        -   `Set-Cookie`: `session_token=<JWT>; HttpOnly; Secure; SameSite=Lax; Path=/; Expires=<timestamp>`
        -   `Location`: `/dashboard` (HTTP 302 Redirect)
    -   **Error Handling**: Returns `400 Bad Request` for invalid codes, `500 Internal Server Error` for backend processing issues, with appropriate JSON error bodies.

### 5.3. Frontend API for User Info (Future, if needed)
-   **Endpoint**: `GET /api/user/me`
    -   **Description**: Retrieves the currently authenticated user's profile information.
    -   **Authentication**: Requires valid `session_token` cookie.
    -   **Response (Body)**:
        ```json
        {
          "id": "12345",
          "name": "John Doe",
          "email": "john.doe@example.com",
          "avatarUrl": "https://example.com/avatar.jpg"
        }
        ```

## 6. Infrastructure
-   **Frontend Hosting**: Static site hosting service (e.g., Vercel, Netlify, AWS S3 + CloudFront). Must support custom domains and HTTPS.
-   **Backend Hosting**: Serverless platform (e.g., AWS Lambda, Google Cloud Functions, Vercel Functions) for the authentication callback endpoint.
-   **DNS Management**: To configure custom domains and point to hosting services.
-   **SSL/TLS Certificates**: Automatically provisioned by hosting providers or managed via services like AWS Certificate Manager to enforce HTTPS.
-   **Google Cloud Project/API Keys**: Required for Google Identity Platform integration (Client ID, Client Secret).
-   **Environment Variables**: Securely store API keys and secrets for both frontend (public client ID) and backend (client secret, JWT secret).

## 7. Testing Strategy
-   **Unit Tests**: 
    -   **Frontend**: Jest and React Testing Library for individual React components (e.g., `GoogleSignInButton`, `ErrorBanner`) to ensure correct rendering and behavior.
    -   **Backend**: Jest or similar for the serverless function logic (token validation, session creation).
-   **Integration Tests**: 
    -   **Frontend-Backend Auth Flow**: Cypress or Playwright to simulate user interaction, initiate Google login, and verify successful redirection to the dashboard and cookie presence.
    -   **Component Interaction**: Verify that `shadcn/ui` components integrate correctly and respond to state changes.
-   **End-to-End Tests**: 
    -   Verify the complete user journey from landing page to authenticated dashboard access.
-   **Security Testing**: 
    -   Manual and automated checks for common web vulnerabilities (XSS, CSRF, insecure direct object references).
    -   Ensure correct `HttpOnly`, `Secure`, `SameSite` attributes on session cookies.

## 8. Deployment
-   **CI/CD Pipeline**: Implement automated build, test, and deployment for both frontend and backend.
    -   **Frontend**: On push to `main` branch, build React app, run tests, deploy static assets to hosting service.
    -   **Backend**: On push to `main` branch, deploy serverless function.
-   **Rollout Strategy**: Direct deployment to production (given it's a foundational setup). Future features will utilize feature flags.
-   **Monitoring and Alerts**: 
    -   **Frontend**: Integrate Sentry or similar for client-side error tracking. Monitor page load times and core web vitals.
    -   **Backend**: Cloud-native monitoring (e.g., AWS CloudWatch, Google Cloud Monitoring) for serverless function invocations, errors, and latency.
    -   **Uptime Monitoring**: External monitoring service to ensure continuous availability of the application.
