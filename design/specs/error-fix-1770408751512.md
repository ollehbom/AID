# Design Specification: Foundational Error Handling System (error-fix-1770408751512)

## Overview
This specification outlines the design for a consistent, clear, and actionable error handling system within the new React application. Its primary goal is to guide users through unexpected issues during critical operations such as authentication, data loading, and general application usage, aligning with the product belief that the product must feel obvious without documentation.

## 1. Complete User Flow (Step-by-Step)

### Scenario A: Authentication Failure (e.g., Google Login)
1.  **User Action**: User clicks "Sign in with Google" on the login screen.
2.  **System Action**: The application initiates the Google OAuth authentication flow.
3.  **Error Occurs**: A problem prevents successful authentication (e.g., network timeout, Google API error, user explicitly denies permissions, server-side callback error).
4.  **Error Display**: The system intercepts the error and presents a user-friendly message. For transient or user-actionable errors, a `Toast` notification (Shadcn UI) will appear briefly. For persistent issues requiring a retry, an inline error message or an `Alert` component will be displayed on the login page.
5.  **User Response**: User reads the error message, understands the problem (if possible), and attempts to retry the login, adjust browser settings, or contact support.

### Scenario B: Dashboard Data Loading Failure
1.  **User Action**: User successfully logs in and is redirected to the Dashboard page.
2.  **System Action**: The Dashboard components initiate data fetching for initial display (e.g., user profile, project list, key metrics).
3.  **Loading State**: A skeleton loader or spinner is displayed in the relevant sections while data is fetched.
4.  **Error Occurs**: Data fetching fails (e.g., backend API is down, network issue, unauthorized access to specific data).
5.  **Error Display**: The loading state is replaced by an inline `Alert` component within the affected dashboard section. This `Alert` contains a clear error message and a "Retry" button.
6.  **User Response**: User reads the error, clicks "Retry" if the issue seems temporary, or navigates to another part of the application.

### Scenario C: General Unexpected Application Error
1.  **User Action**: User interacts with any part of the application.
2.  **Error Occurs**: An unhandled client-side exception or a critical application-wide error occurs (e.g., a React rendering error caught by an Error Boundary).
3.  **Error Display**: A prominent, full-screen overlay or a persistent `Alert` banner at the top of the page is displayed. This message is generic and provides instructions for recovery.
4.  **User Response**: User is prompted to refresh the page or contact support, understanding that the application is in an unstable state.

## 2. All Possible States

*   **Normal State**: UI functions as expected, all data loaded, no errors visible.
*   **Loading State**: Visual indication (spinners, skeleton loaders) that data is being fetched or an action is in progress. This state precedes data display or an error.
*   **Success State**: Brief confirmation that an action was completed successfully. Typically a `Toast` notification (e.g., "Login successful!").
*   **Empty State**: A specific state where no data is available to display, but this is not an error (e.g., "No projects found. Create one to get started.").
*   **Error State**: 
    *   **Transient Error**: Short-lived, often recoverable (e.g., network glitch). Displayed via `Toast` or temporary inline message.
    *   **Contextual/Persistent Error**: Specific to a component or section, requires user action or backend fix. Displayed via an inline `Alert` component within the affected area.
    *   **Critical Application Error**: Unrecoverable error affecting the entire application. Displayed via a full-screen overlay or persistent top-level `Alert`.

## 3. Exact Copy/Microcopy for Each State (Examples)

### Authentication Errors
*   **Generic Login Failure**: "Sign-in failed. Please try again or contact support if the problem persists." (Toast/Inline Alert)
*   **User Denied Permissions**: "Google sign-in cancelled. Please grant permissions to continue." (Toast/Inline Alert)
*   **Network Issue**: "Network error during sign-in. Check your internet connection and try again." (Toast/Inline Alert)
*   **Server Error**: "Oops! Something went wrong on our end. Please try again in a moment." (Toast/Inline Alert)

### Dashboard Data Loading Errors
*   **Generic Data Load Failure**: "Failed to load dashboard data. [Retry button]" (Inline Alert)
*   **Network Issue**: "Could not connect to the server. Check your internet connection and try again. [Retry button]" (Inline Alert)
*   **Unauthorized Access**: "Access denied. You don't have permission to view this data. [Contact Support button]" (Inline Alert)
*   **Empty State (Dashboard)**: "Welcome! It looks like you don't have any active projects yet. [Create Project button]" (Inline Message/Card)

### General Application Errors (Critical)
*   **Headline**: "Something went wrong."
*   **Body**: "An unexpected error occurred. We've been notified. Please refresh the page or contact support if the issue continues."
*   **Actions**: "[Refresh Page button]", "[Contact Support button]" (Full-screen Overlay/Top Alert)

### Success Notifications
*   **Login Success**: "Login successful! Redirecting to dashboard..." (Toast)
*   **Action Success**: "Settings saved successfully." (Toast)

## 4. Error Handling and Edge Cases

*   **Client-Side Validation**: Immediate, real-time feedback for form input errors (e.g., "Email is required", "Invalid email format") using inline text below the input field.
*   **API Error Mapping**: All backend API error codes will be mapped to user-friendly, non-technical messages. Raw backend error details will *not* be exposed to the end-user.
*   **Retry Mechanisms**: For transient network or server-side errors, a clear "Retry" button will be provided. The system should avoid immediate, aggressive retries to prevent overwhelming the server.
*   **React Error Boundaries**: Implement React Error Boundaries around major UI components and sections. If a rendering error occurs within a boundary, only that section will display a fallback UI with a localized error message, preventing the entire application from crashing.
*   **Logging**: All client-side errors and API errors will be logged to an external error monitoring service (e.g., Sentry) for developer review and debugging.
*   **User Guidance**: Every error message must clearly suggest a next step or action the user can take (e.g., "Check your internet connection", "Retry", "Refresh page", "Contact support").
*   **Rate Limiting**: If an action hits a rate limit, a specific message will inform the user and, if possible, indicate when they can try again.

## 5. Transitions and Animations

*   **Toast Notifications**: Slide in from the top-right or bottom-right corner, remain visible for 3-5 seconds, then fade out smoothly.
*   **Inline Messages & Alerts**: Fade in/out with a subtle vertical slide (e.g., using `motion` from Framer Motion or simple CSS transitions) to draw attention to the new content.
*   **Loading States**: Smooth transitions between content and skeleton/spinner using opacity and scale transforms for a fluid user experience.
*   **Error Boundary UI**: The component failing will instantly be replaced by the error fallback UI, maintaining visual integrity of the surrounding layout.